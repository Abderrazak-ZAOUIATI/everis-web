
<div>
  <app-nav-bar></app-nav-bar>
</div>

<div class="container-signup-div">
    <div class="signup-container">
    
    <h4 class="signuptitle">Sign up</h4>
    
    <mat-vertical-stepper [linear]="isLinear" #stepper>
      <mat-step [stepControl]="userInfosFormGroup">
        <form [formGroup]="userInfosFormGroup">
          <ng-template matStepLabel>Fill your details</ng-template>
          
          <mat-form-field>
            <input [(ngModel)]="user.firstName" matInput placeholder="First name" formControlName="firstNameCtrl" required>
            <!--<mat-error *ngIf="email.invalid">{{getErrorMessage()}}</mat-error>-->
          </mat-form-field>
          &nbsp;&nbsp;
          <mat-form-field>
            <input [(ngModel)]="user.lastName" matInput placeholder="Last name"  formControlName="lastNameCtrl" required>
          </mat-form-field>
     
          <br/>
          <mat-form-field>
            <input [(ngModel)]="user.email" matInput placeholder="Email" type="email"  formControlName="emailCtrl" required>
          </mat-form-field>
          &nbsp;&nbsp;
          <mat-form-field>
            <input [(ngModel)]="user.phoneNumber" matInput placeholder="Phone number" type="text" formControlName="phoneNumberCtrl" required>
          </mat-form-field>
    
          <br/>
          <mat-form-field style="width: 100%;">
            <input [(ngModel)]="user.address" matInput placeholder="Address" type="text" formControlName="addressNumberCtrl" required>
          </mat-form-field>
    
          <div>
            <button mat-button matStepperNext>Next</button>
          </div>
        </form>
      </mat-step>
     <mat-step [stepControl]="userPasswordFormGroup">
        <form (submit)="signup(stepper)" ngNativeValidate [formGroup]="userPasswordFormGroup">
          <ng-template matStepLabel>Create password</ng-template>
          <div *ngIf="passwordsError" class="alert-error">{{createAccountErrorMessage}}</div>
          <br/>
          
          <mat-form-field>
            <input matInput [(ngModel)]="user.password"  minlength="8" placeholder="Password" type="password"  formControlName="passwordCtrl" required>
          </mat-form-field>
          &nbsp;&nbsp;
          <mat-form-field>
            <input matInput [(ngModel)]="confirmPassword"  minlength="8" placeholder="Confim your password" type="password" formControlName="confirmPasswordCtrl" required>
          </mat-form-field>
          
          <div>
            <p style="display: flex;margin-bottom: 0px;">
            <button [disabled]="disabledButtonCreateAccount" mat-button matStepperPrevious>Back</button>
            <button [ngClass]="{'buttonWithSpinner': disabledButtonCreateAccount}"  [disabled]="disabledButtonCreateAccount" mat-button >
              
              <span *ngIf="!disabledButtonCreateAccount">Create</span>
             
              <mat-progress-spinner *ngIf="disabledButtonCreateAccount" diameter="20" 
              mode="indeterminate" class="mat-spinner-color" value="100"></mat-progress-spinner>       
            </button>
            </p>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="userConfirmAccountCreation">
        <form  (submit)="accountVerification()" ngNativeValidate [formGroup]="userConfirmAccountCreation">
          <ng-template matStepLabel>Confirm your account</ng-template>
          <div *ngIf="verificationCodeError" class="alert-error">{{createAccountErrorMessage}}</div>
          
          <br/>
           Please enter the code send to your email<br/>
           <span class="codeverificationemail">{{user.email}}</span>
           <br/>
        <mat-form-field>
          <input matInput placeholder="Enter the code" [(ngModel)]="verificationCode" formControlName="userAccountToken" required>
        </mat-form-field>
    
        <div>
          <button [ngClass]="{'buttonWithSpinner': disabledButtonCreateAccount}"  [disabled]="disabledButtonCreateAccount" mat-button >
            
           <span *ngIf="!disabledButtonCreateAccount">Confirm account</span>
          
            <mat-progress-spinner *ngIf="disabledButtonCreateAccount" diameter="20" 
            mode="indeterminate" class="mat-spinner-color" value="100"></mat-progress-spinner> 
          </button>
        </div>
        </form>
      </mat-step>
    
    </mat-vertical-stepper>
    </div>
    </div>
    
    
    
    
    